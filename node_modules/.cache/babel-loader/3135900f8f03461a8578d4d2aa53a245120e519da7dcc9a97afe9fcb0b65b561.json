{"ast":null,"code":"const jwt = require(\"jsonwebtoken\");\nexports.authenticate = (req, res, next) => {\n  const token = req.header(\"x-auth-token\");\n  if (!token) return res.status(401).json({\n    message: \"No token, authorization denied\"\n  });\n  try {\n    const decoded = jwt.verify(token, process.env.JWT_SECRET);\n    req.user = decoded;\n    next();\n  } catch (err) {\n    res.status(401).json({\n      message: \"Invalid token\"\n    });\n  }\n};","map":{"version":3,"names":["jwt","require","exports","authenticate","req","res","next","token","header","status","json","message","decoded","verify","process","env","JWT_SECRET","user","err"],"sources":["C:/Users/Mpilonhle/my-blog-demo/src/middleware/authMiddleware.js"],"sourcesContent":["const jwt = require(\"jsonwebtoken\");\r\n\r\nexports.authenticate = (req, res, next) => {\r\n  const token = req.header(\"x-auth-token\");\r\n  if (!token)\r\n    return res.status(401).json({ message: \"No token, authorization denied\" });\r\n\r\n  try {\r\n    const decoded = jwt.verify(token, process.env.JWT_SECRET);\r\n    req.user = decoded;\r\n    next();\r\n  } catch (err) {\r\n    res.status(401).json({ message: \"Invalid token\" });\r\n  }\r\n};\r\n"],"mappings":"AAAA,MAAMA,GAAG,GAAGC,OAAO,CAAC,cAAc,CAAC;AAEnCC,OAAO,CAACC,YAAY,GAAG,CAACC,GAAG,EAAEC,GAAG,EAAEC,IAAI,KAAK;EACzC,MAAMC,KAAK,GAAGH,GAAG,CAACI,MAAM,CAAC,cAAc,CAAC;EACxC,IAAI,CAACD,KAAK,EACR,OAAOF,GAAG,CAACI,MAAM,CAAC,GAAG,CAAC,CAACC,IAAI,CAAC;IAAEC,OAAO,EAAE;EAAiC,CAAC,CAAC;EAE5E,IAAI;IACF,MAAMC,OAAO,GAAGZ,GAAG,CAACa,MAAM,CAACN,KAAK,EAAEO,OAAO,CAACC,GAAG,CAACC,UAAU,CAAC;IACzDZ,GAAG,CAACa,IAAI,GAAGL,OAAO;IAClBN,IAAI,CAAC,CAAC;EACR,CAAC,CAAC,OAAOY,GAAG,EAAE;IACZb,GAAG,CAACI,MAAM,CAAC,GAAG,CAAC,CAACC,IAAI,CAAC;MAAEC,OAAO,EAAE;IAAgB,CAAC,CAAC;EACpD;AACF,CAAC","ignoreList":[]},"metadata":{},"sourceType":"module","externalDependencies":[]}